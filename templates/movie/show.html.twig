{% extends 'base.html.twig' %}

{% block title %}
{{ movie.title }}
{% endblock %}

{% block body %}

{% include 'movie/includes/rating.html.twig' %}


{% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}

{% if is_granted('FAVORITE_TRUE', userData) %}
<p>
	<a class="btn btn-danger" href="{{path('app_usermovie_favorite', {'slug': movie.slug})}}">Remove from favorites</a>
</p>
{% else %}
<p><a class="btn btn-success" href="{{path('app_usermovie_favorite', {'slug': movie.slug})}}">Add to favorites</a>
</p>
{% endif %}

{% endif %}


{% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}

{% if is_granted('WATCHLATER_TRUE', userData) %}
<p>
	<a class="btn btn-danger" href="{{path('app_usermovie_watchlater', {'slug': movie.slug})}}">Remove from
		Watch Later list</a>
</p>
{% else %}
<p><a class="btn btn-success" href="{{path('app_usermovie_watchlater', {'slug': movie.slug})}}">Add to
		Watch Later list</a>
</p>
{% endif %}

{% endif %}




{% if movie.images %}

<div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
	<div class="carousel-inner ">
		{% for image in movie.images %}
		<div class="carousel-item {% if loop.first %} active{% endif %}">
			<img src="{{asset('images/'~ image.fileName ~'')}}" class="d-block w-100" alt="...">
		</div>
		{% endfor %}

	</div>
	<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
		<span class="carousel-control-prev-icon" aria-hidden="true"></span>
		<span class="visually-hidden">Previous</span>
	</button>
	<button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
		<span class="carousel-control-next-icon" aria-hidden="true"></span>
		<span class="visually-hidden">Next</span>
	</button>
</div>

{% endif %}


{% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}

{% if is_granted('REVIEW_PUBLISHED', userData) %}
My review
</br>
Rating: <b>{{userData.rating != null ? userData.rating : "not rated yet"}}</b>


<br>
Title : {{userData.reviewTitle}}
<p>{{userData.review}}
</p>
<p><a class="btn btn-danger" href="{{path('app_usermovie_deleteReview', {'slug': movie.slug})}}">Delete Review</a>
	<a class="btn btn-secondary" href="{{path('app_usermovies_editReview', {'slug': movie.slug})}}">Edit Review</a>
</p>

{% else %}
<p><a class="btn btn-success" href="{{path('app_usermovies_review', {'slug': movie.slug})}}">Add Review</a></p>
{% endif %}

{% endif %}


{% if pagination %}
<h2>User reviews</h2>

{% for userReview in pagination %}
User: <b>{{userReview.user.getDisplayName}}</b>
</br>
Rating: <b>{{userReview.rating != null ? userReview.rating : "not rated yet"}}</b>

</br>
{{userReview.reviewTitle}}
</br>
<p>{{userReview.review}}
</p>
{% endfor %}
{{pagerfanta(pagination)}}

{% else %}
<h2>No reviews yet, be the first one to review this Title!</h2>
{% endif %}





{% endblock %}